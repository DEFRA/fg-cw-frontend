{% extends '../layouts/case-layout.njk' %}
{% from "govuk/components/tabs/macro.njk" import govukTabs %}
{% from "components/case-tabs/macro.njk" import caseTabs %}
{% from "checkbox/macro.njk" import checkbox %}
{% from "notification-banner/macro.njk" import notificationBanner %}

{% block content %}
  {% if data.assignedUserSuccessMessage %}
    {% set assignmentHtml %}
      <a
        class="govuk-notification-banner__link"
        href="{{ data.assignedUserSuccessMessage.link }}"
        >Case {{ data.assignedUserSuccessMessage.ref }}</a
      >
      has been assigned to
      {{ data.assignedUserSuccessMessage.assignedUserName }}
    {% endset %}

    {{
      notificationBanner({
        heading: data.assignedUserSuccessMessage.heading,
        html: assignmentHtml
      })
    }}
  {% endif %}

  <div class="govuk-grid-row">
    <div class="govuk-grid-column-full">
      <div class="govuk-body" data-testid="app-page-body">
        {% set tabItems = [] %}
        {% for tab in data.tabItems %}
          {%
            set processedTab = {
              label: tab.label,
              id: tab.id,
              panel: {
                html: caseTabs({ data: tab.data })
              }
            }
          %}
          {% set tabItems = (tabItems.push(processedTab), tabItems) %}
        {% endfor %}

        {{ govukTabs({ items: tabItems }) }}
      </div>
    </div>
  </div>
{% endblock %}

{% block bodyEnd %}
  {{ super() }}
{% endblock %}
