{% from "govuk/components/checkboxes/macro.njk" import govukCheckboxes %}
{% from "govuk/components/radios/macro.njk" import govukRadios %}
{% from "govuk/components/textarea/macro.njk" import govukTextarea %}

{%- set status = params.status -%}
{%- set statusOptions = params.statusOptions -%}
{%- set completed = params.completed -%}
{%- set errorMessage = params.errorMessage -%}

{% if statusOptions and statusOptions.length > 0 %}
  {% set radioItems = [] %}
  {% for option in statusOptions %}
    {% if option.conditional %}
      {%
        set radioItems = (radioItems.push({
          value: option.value,
          text: option.text,
          checked: option.checked,
          conditional: { html: govukTextarea(option.conditional) }
        }), radioItems)
      %}
    {% else %}
      {%
        set radioItems = (radioItems.push({
          value: option.value,
          text: option.text,
          checked: option.checked
        }), radioItems)
      %}
    {% endif %}
  {% endfor %}
  {{
    govukRadios({
      name: "status",
      fieldset: {
        legend: {
          text: "Outcome",
          classes: "govuk-fieldset__legend--m"
        }
      },
      items: radioItems,
      errorMessage: errorMessage
    })
  }}
{% else %}
  {{
    govukCheckboxes({
      name: "completed",
      items: [
        {
          value: true,
          id: "task-completed",
          text: "Completed",
          checked: completed
        }
      ]
    })
  }}
{% endif %}
