{% from "govuk/components/summary-list/macro.njk" import govukSummaryList %}
{% from "./heading.njk" import defraHeading %}

{% macro defraSummaryList(params, renderDefraComponent) %}
  {%- set rows = params.rows or [] %}

  {% set summaryRows = [] %}
  {% for row in rows %}
    {# Handle label - can be string or array of components #}
    {%- set labelHtml = "" %}
    {% if row.label is string %}
      {%- set labelHtml = row.label %}
    {% else %}
      {% for labelItem in row.label %}
        {%- set labelHtml = labelHtml + renderDefraComponent(labelItem) %}
      {% endfor %}
    {% endif %}

    {# Handle text - can be string or array of components #}
    {%- set textHtml = "" %}
    {% if row.text is string %}
      {%- set textHtml = row.text %}
    {% else %}
      {% for textItem in row.text %}
        {%- set textHtml = textHtml + renderDefraComponent(textItem) %}
      {% endfor %}
    {% endif %}

    {%
      set summaryRow = {
        key: { html: labelHtml },
        value: { html: textHtml }
      }
    %}
    {% set summaryRows = (summaryRows.push(summaryRow), summaryRows) %}
  {% endfor %}

   {% if params.title %}
     {{ defraHeading({ text: params.title, level: 3 }) }}
   {% endif %}
   {{ govukSummaryList({ rows: summaryRows }) }}
{% endmacro %}
