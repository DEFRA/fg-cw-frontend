{% extends "layouts/case-layout.njk" %}
{% from "govuk/components/table/macro.njk" import govukTable %}
{% from "govuk/components/breadcrumbs/macro.njk" import govukBreadcrumbs %}
{% from "govuk/components/button/macro.njk" import govukButton %}

{% block contentHeader %}
  {{ govukBreadcrumbs({ items: breadcrumbs }) }}
{% endblock %}

{% block contentMain %}
  <div class="moj-page-header-actions">
    <div class="moj-page-header-actions__title">
      <h1 class="govuk-heading-l">{{ pageHeading }}</h1>
    </div>
    <div class="moj-page-header-actions__actions">
      <div class="moj-button-group moj-button-group--inline">
        {{
          govukButton({
            text: "Create user",
            href: data.createUserHref,
            classes: "govuk-button--secondary"
          })
        }}
      </div>
    </div>
  </div>

  {% if data.users.rows.length > 0 %}
    {% set rows = [] %}
    {% for row in data.users.rows %}
      {% set nameLinkHtml %}
        <a class="govuk-link" href="{{ row.viewHref }}">{{ row.name }}</a>
      {% endset %}

      {%
        set tableRow = [
          { html: nameLinkHtml },
          { text: row.email },
          { text: row.lastLogin }
        ]
      %}
      {% set rows = (rows.push(tableRow), rows) %}
    {% endfor %}

    {{
      govukTable({
        head: data.users.head,
        rows: rows,
        firstCellIsHeader: true
      })
    }}
  {% else %}
    <p class="govuk-body">There are no users.</p>
  {% endif %}
{% endblock %}
